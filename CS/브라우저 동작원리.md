# 브라우저 동작원리
## 브라우저란?

웹 브라우저는 동기(Synchronous)적으로 (HTML+CSS), Javascript 언어를 해석하여 내용을 화면에 보여주는 응용 소프트웨어입니다.

그럼 왜 동기적일까?

동기적인 이유는 웹 브라우저가 웹 서버에 필요한 자원을 요청하면 서버는 응답하고 웹 브라우저는 이를 해석한 후 사용자에게 보여줍니다. 보통자원은 HTML 문서지만 PDF, 이미지 등 다양한 형태일 수 있습니다. 예시로는 크롬, 네이버웨일, 파이어폭스, 사파리 등이있습니다.

## 브라우저의 구조

<img src="https://github.com/AI-Expo-2023/Chromatica-Client-V1/assets/100929676/e618fd5e-c0a2-4d54-99ae-b306ab23a9f3">

1. 사용자 인터페이스: 사용자가 접근할 수 있는 영역입니다.(개발자가 아닌 일반 적인 사용자들이 사용할 수 있는 것)
2. 브라우저 엔진: 사용자 인터페이스와 렌더링 엔진 사이의 동작을 제어합니다. Data Storage를 참조하며 로컬에 데이터를 쓰고 읽으면서 다양한 작업을 합니다.
3. 렌더링 엔진: 웹 서버로부터 응답 받은 자원을 웹 브라우저 상에 나타냅니다. 예를 들어 HTML문서를 응답받으면 HTML과 CSS를 파싱 하여 화면에 표시합니다. 브라우저 동작원리에 있어서 매우 중요한 부분이다.
4. 통신: HTTP 요청과 같은, 서버와 통신이 가능하게 하는 네트워크 호출에 사용됩니다.
5. UI 백엔드: select, input등 기본적인 위젯을 그리는 인터페이스입니다.
6. 자바스크립트 해석기: 자바스크립트 코드를 해석하고 실행합니다.
7. 자료 저장소: Cookie, Local Storage, Indexed DB등 브라우저 메모리를 활용히여 저장하는 영역이다

### 렌더링엔진

렌더링 엔진은 HTML,XML,이미지 등 요청받은 내용을 브라우저 화면에 표시하는 엔진입니다.

**렌더링 엔진의 종류**

Blink-크롬, 오페라

Webkit-사파리

Trident-익스플로어

EdgeHtml-마이크로소프트 엣지

**동작 과정**: 렌더링 엔진은 서버로부터 응답받은 HTML 문서를 얻는 것으로 시작합니다. 문서는 8KB 단위로 전송됨

<img src="https://github.com/AI-Expo-2023/Chromatica-Client-V1/assets/100929676/dbe1e23a-cb93-4de9-8a30-a7c21d7f5977">

1. 렌더링 엔진은 HTML문서를 파싱하여 DOM트리를 구축합니다.

<img src="https://github.com/AI-Expo-2023/Chromatica-Client-V1/assets/100929676/5980ff7b-f73e-42e7-9f86-f8e639bd6fdd">

2. 그다음 외부 CSS파일과 함꼐 포함된 스타일 요소를 파싱 합니다.

<img width="400" src="https://github.com/AI-Expo-2023/Chromatica-Client-V1/assets/100929676/97e23b14-742f-443b-9303-92cf4cb2a36a">

1. DOM트리와 2의 결과물을 합쳐 렌더 트리를 구축합니다.
    
     DOM 트리가 구축되는 동안 브라우저는 DOM 트리를 기반으로 렌더 트리를 생성합니다. 렌더 트리는 문서를 시각적인 구성 요소로 만들어주는 역할을 합니다. 웹킷은 이 구성 요소를 "렌더러(rendere)" 또는 "렌더 객체(render object)"라는 용어를 사용합니다. 렌더러는 자신과 자식 요소를 어떻게 배치하고 그려내야 하는지 알고 있습니다. 렌더러는 DOM 요소에 부합하지만 1:1로 대응하는 관계는 아닙니다. 그 이유는<head>,display:'none'와 같은 사용자가 볼 수 없는 DOM 요소는 렌더 트리에 추가되지 않습니다. (visibility 속성에 "hidden" 값이 할당된 요소는 트리에 나타납니다.)
    
    <img src="https://github.com/AI-Expo-2023/Chromatica-Client-V1/assets/100929676/ecff564b-e962-4369-bb85-56527db1c4ff">
    
2. 렌더 트리 각 노드에 대해 화면 상에서 배치할 곳을 결정합니다.
    
    렌더 트리는 위치와 크기를 가지고 있지 않기 때문에, 어느 공간에 위치해 할지 각 객체들에게 위치(position)와 크기(size)를 결정해줍니다.
    
3. UI 백엔드에서 렌더 트리의 각 노드를 그립니다.
    
    렌더 트리가 만들어져 레이아웃이 구성되었으면 UI 백엔드가 동작하여 렌더 트리의 각 객체를 화면의 픽셀(px) 값으로 나타냅니다.
    

### 그럼 Javascript는 어떻게 처리가 될까?

javascript는 렌더링 엔진에서 처리가되지않고 자바스크립트 엔진에서 따로 처리한다.